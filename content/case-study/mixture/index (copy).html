<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Bruno Nicenboim" />

<meta name="date" content="2025-06-13" />

<title>Case study: Nasalization</title>

<script src="mixture-nasal_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="mixture-nasal_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="mixture-nasal_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="mixture-nasal_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="mixture-nasal_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="mixture-nasal_files/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="mixture-nasal_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="mixture-nasal_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="mixture-nasal_files/navigation-1.1/tabsets.js"></script>
<script src="mixture-nasal_files/navigation-1.1/codefolding.js"></script>
<link href="mixture-nasal_files/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="mixture-nasal_files/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Case study: Nasalization</h1>
<h4 class="author">Bruno Nicenboim</h4>
<h4 class="date">2025-06-13</h4>

</div>


<div class="sourceCode" id="cb1"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## Global options</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">options</span>(<span class="at">max.print =</span> <span class="st">&quot;75&quot;</span>,</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>        <span class="at">width =</span> <span class="dv">80</span>,</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>        <span class="at">tibble.width =</span> <span class="dv">80</span>)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">1</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>                    <span class="at">cache =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>                    <span class="at">prompt =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>                    <span class="at">cache.lazy =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>                    <span class="at">tidy =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>                    <span class="at">comment =</span> <span class="cn">NA</span>,</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>                    <span class="at">message =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>                    <span class="at">warning =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>knitr<span class="sc">::</span>opts_knit<span class="sc">$</span><span class="fu">set</span>(<span class="at">width =</span> <span class="dv">80</span>)</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">cache.extra =</span> knitr<span class="sc">::</span>rand_seed)</span></code></pre></div>
<style>
.exercise {
  border: 2px solid #007ACC;
  background-color: #f0f8ff;
  padding: 1em;
  margin: 1em 0;
  border-radius: 6px;
}

.exercise h3 {
  margin-top: 0;
  color: #005a9c;
}

.note {
  border-left: 5px solid #1e90ff;
  background-color: #eef6fc;
  padding: 1em;
  margin: 1em 0;
}

.warning {
  border-left: 5px solid #d9534f;
  background-color: #fdf2f2;
  padding: 1em;
  margin: 1em 0;
}
</style>
<div id="introduction" class="section level1 unnumbered">
<h1>Introduction</h1>
<p>This case study examines how <em>nasalance</em> varies across three etymological categories of Basque aspirates: <strong>oral</strong>, <strong>contact-nasalized</strong> (i.e., following a nasal consonant), and historically <strong>nasalized</strong> aspirates that are reported to be in flux.</p>
</div>
<div id="set-up" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Set-up</h1>
<div id="packages" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Packages</h2>
<p>The analysis relies on <strong>tidytable</strong> for fast data manipulation, <strong>cmdstanr</strong> for Stan interfacing, and a handful of tidy-Bayes helpers for visualisation and model comparison.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(tidytable) <span class="co"># nice alternative to dplyr</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(cmdstanr)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">library</span>(posterior)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="fu">library</span>(loo)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> <span class="dv">4</span>)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">write_bib</span>(<span class="fu">.packages</span>(), <span class="st">&quot;r-references.bib&quot;</span>)</span></code></pre></div>
</div>
<div id="files" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Files</h2>
<p>We’ll use the following files</p>
<ul>
<li><a href="./nas_data.RDS"><code>nas_data.RDS</code></a></li>
<li><a href="./beta2.stan"><code>beta2.stan</code></a></li>
<li><a href="./mix.stan"><code>mix.stan</code></a></li>
<li><a href="./nonmix.stan"><code>nonmix.stan</code></a></li>
<li><a href="./mix_s.stan"><code>mix_s.stan</code></a></li>
<li><a href="./mix_s2.stan"><code>mix_s2.stan</code></a></li>
<li><a href="./mixture-nasal.Rmd"><code>mixture-nasal.Rmd</code></a></li>
</ul>
</div>
<div id="data-from-iñigo-urrestarazu-porta" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Data from Iñigo Urrestarazu-Porta</h2>
<p>Basque speakers of the Zuberoan variety were recorded with a nasometer. The etymology has three relevant levels:</p>
<ol style="list-style-type: decimal">
<li><strong>contact</strong></li>
<li><strong>nasalized</strong></li>
<li><strong>oral</strong></li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>nas_data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;nas_data.RDS&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>    <span class="at">etymology =</span> E,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>    <span class="at">root =</span> R,</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>    <span class="at">speaker =</span> S,</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>    <span class="at">nasalance =</span> N</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(nasalance)) <span class="sc">|&gt;</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  <span class="fu">filter</span>(etymology <span class="sc">!=</span> <span class="st">&quot;assimilated&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>    <span class="at">E =</span> <span class="fu">as.factor</span>(etymology) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>    <span class="at">R =</span> <span class="fu">as.factor</span>(root) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>    <span class="at">speaker =</span> <span class="fu">as.factor</span>(speaker) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>nas_data</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["speaker"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["root"],"name":[2],"type":["chr"],"align":["left"]},{"label":["etymology"],"name":[3],"type":["chr"],"align":["left"]},{"label":["nasalance"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["E"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["R"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"diharu","3":"nasalized","4":"0.102","5":"2","6":"26"},{"1":"1","2":"ihakin","3":"oral","4":"0.136","5":"3","6":"37"},{"1":"1","2":"ihaute","3":"nasalized","4":"0.170","5":"2","6":"41"},{"1":"1","2":"ihintz","3":"nasalized","4":"0.219","5":"2","6":"44"},{"1":"1","2":"ahate","3":"nasalized","4":"0.232","5":"2","6":"8"},{"1":"1","2":"zehe","3":"nasalized","4":"0.144","5":"2","6":"64"},{"1":"1","2":"kahixka","3":"nasalized","4":"0.300","5":"2","6":"46"},{"1":"1","2":"ehe-no","3":"nasalized","4":"0.128","5":"2","6":"28"},{"1":"1","2":"ehe-no","3":"nasalized","4":"0.128","5":"2","6":"28"},{"1":"1","2":"halahola","3":"oral","4":"0.215","5":"3","6":"36"},{"1":"1","2":"halahola","3":"oral","4":"0.256","5":"3","6":"36"},{"1":"1","2":"ahal","3":"nasalized","4":"0.248","5":"2","6":"2"},{"1":"1","2":"desuhue","3":"nasalized","4":"0.353","5":"2","6":"25"},{"1":"1","2":"ohore","3":"nasalized","4":"0.125","5":"2","6":"53"},{"1":"1","2":"ihi","3":"nasalized","4":"0.164","5":"2","6":"43"},{"1":"1","2":"behe","3":"oral","4":"0.139","5":"3","6":"20"},{"1":"1","2":"lañho","3":"contact","4":"0.483","5":"1","6":"47"},{"1":"1","2":"ahul","3":"oral","4":"0.174","5":"3","6":"11"},{"1":"1","2":"gihaur","3":"nasalized","4":"0.158","5":"2","6":"35"},{"1":"1","2":"ehiza","3":"nasalized","4":"0.267","5":"2","6":"30"},{"1":"1","2":"ahate","3":"nasalized","4":"0.234","5":"2","6":"8"},{"1":"1","2":"behi","3":"oral","4":"0.177","5":"3","6":"21"},{"1":"1","2":"bahe","3":"nasalized","4":"0.197","5":"2","6":"18"},{"1":"1","2":"asteharte","3":"oral","4":"0.111","5":"3","6":"16"},{"1":"1","2":"zahar","3":"nasalized","4":"0.198","5":"2","6":"63"},{"1":"1","2":"ehe-bleach","3":"oral","4":"0.136","5":"3","6":"27"},{"1":"1","2":"aharrausi","3":"oral","4":"0.195","5":"3","6":"7"},{"1":"1","2":"gihaur","3":"nasalized","4":"0.113","5":"2","6":"35"},{"1":"1","2":"aholku","3":"nasalized","4":"0.225","5":"2","6":"10"},{"1":"1","2":"ahalke","3":"nasalized","4":"0.234","5":"2","6":"3"},{"1":"1","2":"aihai","3":"oral","4":"0.188","5":"3","6":"13"},{"1":"1","2":"aholku","3":"nasalized","4":"0.240","5":"2","6":"10"},{"1":"1","2":"ohol","3":"nasalized","4":"0.195","5":"2","6":"52"},{"1":"1","2":"ahur","3":"oral","4":"0.249","5":"3","6":"12"},{"1":"1","2":"lohi","3":"nasalized","4":"0.163","5":"2","6":"50"},{"1":"1","2":"aha","3":"oral","4":"0.189","5":"3","6":"1"},{"1":"1","2":"eñhe","3":"contact","4":"0.579","5":"1","6":"33"},{"1":"1","2":"ahantzi","3":"nasalized","4":"0.239","5":"2","6":"4"},{"1":"1","2":"sehi","3":"nasalized","4":"0.158","5":"2","6":"55"},{"1":"1","2":"ahul","3":"oral","4":"0.144","5":"3","6":"11"},{"1":"1","2":"zahar","3":"nasalized","4":"0.223","5":"2","6":"63"},{"1":"1","2":"anho","3":"contact","4":"0.518","5":"1","6":"15"},{"1":"1","2":"añharba","3":"contact","4":"0.492","5":"1","6":"14"},{"1":"1","2":"ahizpa","3":"nasalized","4":"0.160","5":"2","6":"9"},{"1":"1","2":"aholku","3":"nasalized","4":"0.094","5":"2","6":"10"},{"1":"1","2":"ohore","3":"nasalized","4":"0.067","5":"2","6":"53"},{"1":"1","2":"ihes","3":"nasalized","4":"0.184","5":"2","6":"42"},{"1":"1","2":"ehi-finger","3":"oral","4":"0.183","5":"3","6":"29"},{"1":"1","2":"ihaur","3":"nasalized","4":"0.142","5":"2","6":"40"},{"1":"1","2":"auher","3":"oral","4":"0.160","5":"3","6":"17"},{"1":"1","2":"ahizpa","3":"nasalized","4":"0.219","5":"2","6":"9"},{"1":"1","2":"bihi","3":"oral","4":"0.178","5":"3","6":"22"},{"1":"1","2":"uñhu","3":"contact","4":"0.563","5":"1","6":"58"},{"1":"1","2":"iharrausi","3":"nasalized","4":"0.160","5":"2","6":"39"},{"1":"1","2":"xehe","3":"nasalized","4":"0.116","5":"2","6":"61"},{"1":"1","2":"aharrausi","3":"oral","4":"0.245","5":"3","6":"7"},{"1":"1","2":"eihe","3":"oral","4":"0.160","5":"3","6":"32"},{"1":"1","2":"ahal","3":"nasalized","4":"0.183","5":"2","6":"2"},{"1":"1","2":"ahari","3":"nasalized","4":"0.204","5":"2","6":"6"},{"1":"1","2":"bihotz","3":"oral","4":"0.157","5":"3","6":"23"},{"1":"1","2":"sehi","3":"nasalized","4":"0.149","5":"2","6":"55"},{"1":"1","2":"ahardi","3":"nasalized","4":"0.139","5":"2","6":"5"},{"1":"1","2":"behi","3":"oral","4":"0.163","5":"3","6":"21"},{"1":"1","2":"ihardetsi","3":"nasalized","4":"0.160","5":"2","6":"38"},{"1":"1","2":"ohatu","3":"oral","4":"0.153","5":"3","6":"51"},{"1":"1","2":"bihurtu","3":"oral","4":"0.130","5":"3","6":"24"},{"1":"1","2":"zuhur","3":"nasalized","4":"0.130","5":"2","6":"65"},{"1":"1","2":"ihue","3":"nasalized","4":"0.137","5":"2","6":"45"},{"1":"1","2":"ehiza","3":"nasalized","4":"0.183","5":"2","6":"30"},{"1":"1","2":"ihintz","3":"nasalized","4":"0.186","5":"2","6":"44"},{"1":"1","2":"ihardetsi","3":"nasalized","4":"0.199","5":"2","6":"38"},{"1":"1","2":"gehien-gehiago","3":"oral","4":"0.230","5":"3","6":"34"},{"1":"1","2":"lehoi","3":"nasalized","4":"0.137","5":"2","6":"49"},{"1":"2","2":"ahul","3":"oral","4":"0.189","5":"3","6":"11"},{"1":"2","2":"sehi","3":"nasalized","4":"0.180","5":"2","6":"55"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The quick summary below confirms the expected ranking: <em>contact</em> tokens are the most nasal, <em>oral</em> tokens the least, and the <em>nasalized</em> class falls somewhere in between.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>(summary <span class="ot">&lt;-</span> nas_data <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(nasalance),</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">sd</span>(nasalance),</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>    <span class="at">SE =</span> <span class="fu">sd</span>(nasalance) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>    <span class="at">lq =</span> <span class="fu">quantile</span>(nasalance, <span class="fl">0.025</span>),</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>    <span class="at">hq =</span> <span class="fu">quantile</span>(nasalance, <span class="fl">0.975</span>),</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">c</span>(<span class="st">&quot;etymology&quot;</span>, <span class="st">&quot;E&quot;</span>)))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["etymology"],"name":[1],"type":["chr"],"align":["left"]},{"label":["E"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["lq"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["hq"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"contact","2":"1","3":"0.54","4":"0.115","5":"0.0145","6":"0.310","7":"0.75"},{"1":"nasalized","2":"2","3":"0.23","4":"0.176","5":"0.0086","6":"0.054","7":"0.72"},{"1":"oral","2":"3","3":"0.17","4":"0.099","5":"0.0067","6":"0.054","7":"0.46"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">ggplot</span>(nas_data, <span class="fu">aes</span>(<span class="at">x =</span> nasalance, <span class="at">fill =</span> etymology, <span class="at">color =</span> etymology)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Distribution of nasalance by etymology&quot;</span>,</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Nasalance (N)&quot;</span>,</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Density&quot;</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="mixture-nasal_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>We are modelling proportions of nasalance, with a categorical predictor (etymological category or group), to try to understand if <em>some</em> aspirates /h/ are nasalized in Basque.</p>
<p><strong>Assumptions:</strong></p>
<ul>
<li><p><strong>Orals</strong> should have low proportion values (~20%).</p></li>
<li><p><strong>Contact</strong> refers to aspirates after a nasal consonant, so they should have high values (~50–60%).</p></li>
<li><p><strong>Nasalized</strong> aspirates are being lost in the language:</p>
<ul>
<li>Some speakers never produce them as such (N ~20%).</li>
<li>Even among those who maintain the distinction, some lexical items have lost nasality.</li>
</ul></li>
</ul>
<p>The core research question is therefore whether the <em>nasalized</em> category is best described by a <strong>mixture</strong> of two latent sub-processes.</p>
<hr />
</div>
</div>
<div id="modeling-the-mixture-of-two-components" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Modeling the mixture of two components</h1>
<p>We focus here on a two-component mixture model <span class="citation">(Nicenboim, Schad, and Vasishth 2025)</span>, where each component represents a distinct cognitive process. The latent vector <span class="math inline">\(\mathbf{z}\)</span> indicates which component an observation belongs to:</p>
<p><span class="math display" id="eq:mixz">\[\begin{equation}
\begin{aligned}
z_n \sim \mathit{Bernoulli}(\theta)\\
y_n \sim
\begin{cases}
p_1(\Theta_1), &amp; \text{ if } z_n =1 \\
p_2(\Theta_2), &amp; \text{ if } z_n=0
\end{cases}
\end{aligned}
\tag{2.1}
\end{equation}\]</span></p>
<p>In this specific case, <span class="math inline">\(y_n\)</span> is the observed nasalance of a historically nasalized root, and the latent binary indicator <span class="math inline">\(z_n\)</span> determines whether the token was produced via the <em>contact-like</em> process <span class="math inline">\((p_1)\)</span> or the <em>oral-like</em> process <span class="math inline">\((p_2)\)</span>.</p>
<div id="data-simulation" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Data simulation</h2>
<p>In the next few chunks we generate two artificial data sets so that we can stress-test our models: one <strong>true mixture</strong> and one <strong>true non-mixture</strong>. We ignore subject‑level variability for now.</p>
<div id="a-custom-beta-parameterisation" class="section level3" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> A custom Beta parameterisation</h3>
<p>Before simulating, we re-express the Beta distribution in terms of a more intuitive mean/<span class="math inline">\(\sigma\)</span> parameterisation. The helper functions <code>beta_pars()</code> and <code>rbeta2()</code> <em>only</em> wrap the algebra–they do not affect inference later on, but they make simulation vastly more readable.</p>
<p><span class="math display">\[
\text{var} &lt; \mu (1 - \mu), \quad
\nu = \frac{\mu(1 - \mu)}{\text{var}} - 1, \quad
\alpha = \mu \nu, \quad \beta = (1 - \mu) \nu
\]</span></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>beta_pars <span class="ot">&lt;-</span> <span class="cf">function</span>(mean, sd) {</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  var <span class="ot">&lt;-</span> sd<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> ((<span class="dv">1</span> <span class="sc">-</span> mean) <span class="sc">/</span> var <span class="sc">-</span> <span class="dv">1</span> <span class="sc">/</span> mean) <span class="sc">*</span> mean<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> alpha <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> mean <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">alpha =</span> alpha, <span class="at">beta =</span> beta)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>}</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>rbeta2 <span class="ot">&lt;-</span> <span class="cf">function</span>(n, mean, sd) {</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>  pars <span class="ot">&lt;-</span> <span class="fu">beta_pars</span>(mean, sd)</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>  <span class="fu">rbeta</span>(<span class="at">n =</span> n, <span class="at">shape1 =</span> pars<span class="sc">$</span>alpha, <span class="at">shape2 =</span> pars<span class="sc">$</span>beta)</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="simulate-data-from-a-mixture-process" class="section level3" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Simulate data from a <em>mixture</em> process</h3>
<p><code>prob_nas</code> below is the root-level probability that a historically nasalised aspirate is realised via a “high-nasalance mechanism” (as in contact condition). By varying this single probability you can dial-in anything from a pure-contact to a pure-oral realisation.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">99</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>true <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="at">mu_oral =</span> <span class="fl">0.166</span>,</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  <span class="at">sigma_oral =</span> <span class="fl">0.0993</span>,</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  <span class="at">mu_contact =</span> <span class="fl">0.543</span>,</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  <span class="at">sigma_contact =</span> <span class="fl">0.115</span>,</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>  <span class="at">prob_nas =</span> <span class="fl">0.15</span> <span class="co"># made-up probability of nasalization</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>)</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>nas_oral <span class="ot">&lt;-</span> <span class="fu">rbeta2</span>(N, <span class="at">mean =</span> true<span class="sc">$</span>mu_oral, <span class="at">sd =</span> true<span class="sc">$</span>sigma_oral)</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>nas_contact <span class="ot">&lt;-</span> <span class="fu">rbeta2</span>(N, <span class="at">mean =</span> true<span class="sc">$</span>mu_contact, <span class="at">sd =</span> true<span class="sc">$</span>sigma_contact)</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>is_nas <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> true<span class="sc">$</span>prob_nas)</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>nas_nasalized <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>  is_nas <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>  <span class="fu">rbeta2</span>(N, <span class="at">mean =</span> true<span class="sc">$</span>mu_contact, <span class="at">sd =</span> true<span class="sc">$</span>sigma_contact), <span class="co"># contact</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>  <span class="fu">rbeta2</span>(N, <span class="at">mean =</span> true<span class="sc">$</span>mu_oral, <span class="at">sd =</span> true<span class="sc">$</span>sigma_oral)         <span class="co"># oral</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a>)</span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a>mix_data <span class="ot">&lt;-</span> <span class="fu">tidytable</span>(</span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a>  <span class="at">etymology =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;oral&quot;</span>, <span class="st">&quot;contact&quot;</span>, <span class="st">&quot;nasalized&quot;</span>), <span class="at">each =</span> N),</span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>  <span class="at">nasalance =</span> <span class="fu">c</span>(nas_oral, nas_contact, nas_nasalized)</span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">E =</span> <span class="fu">as.factor</span>(etymology) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>())</span></code></pre></div>
<p>Check distribution and visualize:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>mix_data <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(nasalance),</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">sd</span>(nasalance),</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>    <span class="at">SE =</span> <span class="fu">sd</span>(nasalance) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>    <span class="at">lq =</span> <span class="fu">quantile</span>(nasalance, <span class="fl">0.025</span>),</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>    <span class="at">hq =</span> <span class="fu">quantile</span>(nasalance, <span class="fl">0.975</span>),</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">c</span>(<span class="st">&quot;etymology&quot;</span>, <span class="st">&quot;E&quot;</span>)</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>  )</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["etymology"],"name":[1],"type":["chr"],"align":["left"]},{"label":["E"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["lq"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["hq"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"contact","2":"1","3":"0.55","4":"0.119","5":"0.0119","6":"0.323","7":"0.74"},{"1":"nasalized","2":"2","3":"0.22","4":"0.169","5":"0.0169","6":"0.020","7":"0.69"},{"1":"oral","2":"3","3":"0.16","4":"0.089","5":"0.0089","6":"0.033","7":"0.37"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">ggplot</span>(mix_data, <span class="fu">aes</span>(<span class="at">x =</span> nasalance, <span class="at">fill =</span> etymology, <span class="at">color =</span> etymology)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;SIMULATED distribution of nasalance by etymology (mixture)&quot;</span>,</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Nasalance (N)&quot;</span>,</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Density&quot;</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="mixture-nasal_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div class="note">
<p>Experiment with different values of <code>prob_nas</code> and observe the effect on the distribution.</p>
</div>
</div>
<div id="simulate-data-from-a-non-mixture-process" class="section level3" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> Simulate data from a <em>non-mixture</em> process</h3>
<p>Here every category gets its <em>own</em> Beta distribution. The parameters for <em>oral</em> and <em>contact</em> are the same as above; the <em>nasalized</em> mean/sd are set to match the empirical data.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">99</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>true2 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="at">mu_oral =</span> true<span class="sc">$</span>mu_oral,</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  <span class="at">sigma_oral =</span> true<span class="sc">$</span>sigma_oral,</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  <span class="at">mu_contact =</span> true<span class="sc">$</span>mu_contact,</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  <span class="at">sigma_contact =</span> true<span class="sc">$</span>sigma_contact,</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>  <span class="at">mu_nasalized =</span> <span class="fl">0.233</span>,</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>  <span class="at">sigma_nasalized =</span> <span class="fl">0.176</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>)</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>nas_oral <span class="ot">&lt;-</span> <span class="fu">rbeta2</span>(N, <span class="at">mean =</span> true2<span class="sc">$</span>mu_oral, <span class="at">sd =</span> true2<span class="sc">$</span>sigma_oral)</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>nas_contact <span class="ot">&lt;-</span> <span class="fu">rbeta2</span>(N, <span class="at">mean =</span> true2<span class="sc">$</span>mu_contact, <span class="at">sd =</span> true2<span class="sc">$</span>sigma_contact)</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>nas_nasalized2 <span class="ot">&lt;-</span> <span class="fu">rbeta2</span>(N, <span class="at">mean =</span> true2<span class="sc">$</span>mu_nasalized, <span class="at">sd =</span> true2<span class="sc">$</span>sigma_nasalized)</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>nonmix_data <span class="ot">&lt;-</span> <span class="fu">tidytable</span>(</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>  <span class="at">etymology =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;oral&quot;</span>, <span class="st">&quot;contact&quot;</span>, <span class="st">&quot;nasalized&quot;</span>), <span class="at">each =</span> N),</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>  <span class="at">nasalance =</span> <span class="fu">c</span>(nas_oral, nas_contact, nas_nasalized2)</span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">E =</span> <span class="fu">as.factor</span>(etymology) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>())</span></code></pre></div>
<p>Check distribution and visualize:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>nonmix_data <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(nasalance),</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(nasalance),</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>            <span class="at">SE =</span> <span class="fu">mean</span>(nasalance)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>            <span class="at">lq =</span> <span class="fu">quantile</span>(nasalance, <span class="fl">0.025</span>),</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>            <span class="at">hq =</span> <span class="fu">quantile</span>(nasalance, <span class="fl">0.975</span>),</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>            <span class="at">.by =</span> <span class="fu">c</span>(<span class="st">&quot;etymology&quot;</span>,<span class="st">&quot;E&quot;</span>))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["etymology"],"name":[1],"type":["chr"],"align":["left"]},{"label":["E"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["lq"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["hq"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"contact","2":"1","3":"0.55","4":"0.119","5":"0.055","6":"0.323","7":"0.74"},{"1":"nasalized","2":"2","3":"0.23","4":"0.183","5":"0.023","6":"0.011","7":"0.64"},{"1":"oral","2":"3","3":"0.16","4":"0.089","5":"0.016","6":"0.033","7":"0.37"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">ggplot</span>(nonmix_data, <span class="fu">aes</span>(<span class="at">x =</span> nasalance, <span class="at">fill =</span> etymology, <span class="at">color =</span> etymology))  <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SIMULATED distribution of nasalance by etymology&quot;</span>,</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;N&quot;</span>,</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="mixture-nasal_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p><strong>Both distributions are visually similar, underscoring the difficulty of distinguishing the underlying generative processes by eye alone.</strong></p>
<hr />
</div>
</div>
<div id="fitting-the-simulated-data" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Fitting the simulated data</h2>
<p>We next fit the simulated data sets with <em>both</em> a mixture and a non-mixture model. We expect the following:</p>
<ol style="list-style-type: decimal">
<li><p>the mixture model should outperform when the data are a true mixture; and</p></li>
<li><p>the non-mixture model should win when the data really come from three separate Beta distributions.</p></li>
</ol>
<hr />
<div id="stan-implementation-two-component-mixture" class="section level3" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Stan implementation: two-component mixture</h3>
<p>The Stan program below encodes the likelihood</p>
<p><span class="math display">\[
  p(y_n\mid\Theta) = \theta\,p_1(y_n\mid\Theta_1) + (1-\theta)\,p_2(y_n\mid\Theta_2),
\]</span></p>
<p>where <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span> are Beta distributions parameterised by their means and standard deviations. Because Stan does not allow discrete parameters in the <code>parameters</code> block, we marginalise over the latent indicator $z_n$ via <code>log_sum_exp</code>.</p>
<p>Stan model:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co">#include beta2.stan</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span> = <span class="dv">1</span>&gt; N;</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>  <span class="dt">vector</span>[N] nasalance;</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  <span class="dt">array</span>[N] <span class="dt">int</span>&lt;<span class="kw">lower</span> = <span class="dv">1</span>&gt; E;</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>}</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="kw">parameters</span> {</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span> = <span class="dv">0</span>, <span class="kw">upper</span> = <span class="dv">1</span>&gt; mu_contact;</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span> = <span class="dv">0</span>, <span class="kw">upper</span> = sqrt(mu_contact*(<span class="dv">1</span>-mu_contact))&gt; sigma_contact;</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span> = <span class="dv">0</span>, <span class="kw">upper</span> = <span class="dv">1</span> &gt; mu_oral;</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>= <span class="dv">0</span>, <span class="kw">upper</span> = sqrt(mu_oral*(<span class="dv">1</span>-mu_oral))&gt; sigma_oral;</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span> = <span class="dv">0</span>, <span class="kw">upper</span> = <span class="dv">1</span>&gt; prob_nas;</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>}</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>  <span class="co">// priors for the task component</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>  <span class="kw">target +=</span> normal_lpdf(mu_contact | <span class="fl">0.6</span>, <span class="fl">0.2</span>);</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>  <span class="kw">target +=</span> normal_lpdf(mu_oral | <span class="fl">0.2</span>, <span class="fl">0.3</span>);</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>  <span class="kw">target +=</span> normal_lpdf(sigma_oral | <span class="dv">0</span>, <span class="fl">0.3</span>);</span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a>  <span class="kw">target +=</span> normal_lpdf(sigma_contact | <span class="dv">0</span>, <span class="fl">0.3</span>);</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>  <span class="kw">target +=</span> beta_lpdf(prob_nas | <span class="dv">3</span>, <span class="dv">10</span>);</span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a>  <span class="cf">for</span>(n <span class="cf">in</span> <span class="dv">1</span>:N){</span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a>    <span class="cf">if</span>(E[n] == <span class="dv">1</span>)  <span class="co">// contact</span></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a>      <span class="kw">target +=</span>  beta2_lpdf(nasalance[n] | mu_contact, sigma_contact);</span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a>     <span class="cf">else</span> <span class="cf">if</span>(E[n] == <span class="dv">3</span>)  <span class="co">// oral</span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a>       <span class="kw">target +=</span> beta2_lpdf(nasalance[n] | mu_oral, sigma_oral);</span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span>(E[n] == <span class="dv">2</span>) <span class="co">//nas</span></span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a>       <span class="kw">target +=</span> log_sum_exp(log(prob_nas) +</span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a>                  beta2_lpdf(nasalance[n] | mu_contact, sigma_contact),</span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a>                  log1m(prob_nas) +</span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a>                  beta2_lpdf(nasalance[n] | mu_oral, sigma_oral));</span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a>  }</span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a>}</span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a><span class="kw">generated quantities</span> {</span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a>  <span class="dt">vector</span>[N] log_lik;</span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a> <span class="cf">for</span>(n <span class="cf">in</span> <span class="dv">1</span>:N){</span>
<span id="cb14-38"><a href="#cb14-38" tabindex="-1"></a>    <span class="cf">if</span>(E[n] == <span class="dv">1</span>)  <span class="co">// contact</span></span>
<span id="cb14-39"><a href="#cb14-39" tabindex="-1"></a>      log_lik[n] =  beta2_lpdf(nasalance[n] | mu_contact, sigma_contact);</span>
<span id="cb14-40"><a href="#cb14-40" tabindex="-1"></a>     <span class="cf">else</span> <span class="cf">if</span>(E[n] == <span class="dv">3</span>)  <span class="co">// oral</span></span>
<span id="cb14-41"><a href="#cb14-41" tabindex="-1"></a>       log_lik[n] = beta2_lpdf(nasalance[n] | mu_oral, sigma_oral);</span>
<span id="cb14-42"><a href="#cb14-42" tabindex="-1"></a>     <span class="cf">else</span> <span class="cf">if</span>(E[n] == <span class="dv">2</span>) <span class="co">//nas</span></span>
<span id="cb14-43"><a href="#cb14-43" tabindex="-1"></a>       log_lik[n] = log_sum_exp(log(prob_nas) +</span>
<span id="cb14-44"><a href="#cb14-44" tabindex="-1"></a>                                beta2_lpdf(nasalance[n] | mu_contact, sigma_contact),</span>
<span id="cb14-45"><a href="#cb14-45" tabindex="-1"></a>                                log1m(prob_nas) +</span>
<span id="cb14-46"><a href="#cb14-46" tabindex="-1"></a>                                beta2_lpdf(nasalance[n] | mu_oral, sigma_oral));</span>
<span id="cb14-47"><a href="#cb14-47" tabindex="-1"></a>  }</span>
<span id="cb14-48"><a href="#cb14-48" tabindex="-1"></a></span>
<span id="cb14-49"><a href="#cb14-49" tabindex="-1"></a>  <span class="co">// Posterior predictions:</span></span>
<span id="cb14-50"><a href="#cb14-50" tabindex="-1"></a>  <span class="dt">vector</span>[N] nasalance_rep;</span>
<span id="cb14-51"><a href="#cb14-51" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span>:N) {</span>
<span id="cb14-52"><a href="#cb14-52" tabindex="-1"></a>    <span class="cf">if</span> (E[n] == <span class="dv">1</span>)</span>
<span id="cb14-53"><a href="#cb14-53" tabindex="-1"></a>      nasalance_rep[n] = beta2_rng(mu_contact, sigma_contact);</span>
<span id="cb14-54"><a href="#cb14-54" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (E[n] == <span class="dv">3</span>)</span>
<span id="cb14-55"><a href="#cb14-55" tabindex="-1"></a>      nasalance_rep[n] = beta2_rng(mu_oral, sigma_oral);</span>
<span id="cb14-56"><a href="#cb14-56" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (E[n] == <span class="dv">2</span>) {</span>
<span id="cb14-57"><a href="#cb14-57" tabindex="-1"></a>      <span class="cf">if</span> (bernoulli_rng(prob_nas) == <span class="dv">1</span>)</span>
<span id="cb14-58"><a href="#cb14-58" tabindex="-1"></a>        nasalance_rep[n] = beta2_rng(mu_contact, sigma_contact);</span>
<span id="cb14-59"><a href="#cb14-59" tabindex="-1"></a>      <span class="cf">else</span></span>
<span id="cb14-60"><a href="#cb14-60" tabindex="-1"></a>        nasalance_rep[n] = beta2_rng(mu_oral, sigma_oral);</span>
<span id="cb14-61"><a href="#cb14-61" tabindex="-1"></a>    }</span>
<span id="cb14-62"><a href="#cb14-62" tabindex="-1"></a>  }</span>
<span id="cb14-63"><a href="#cb14-63" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>mix_m <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="st">&quot;./mix.stan&quot;</span>)</span></code></pre></div>
<hr />
</div>
<div id="model-fits" class="section level3" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Model fits</h3>
<p>Posterior recovery plots (<code>mcmc_recover_hist</code>) show that all five parameters are recovered when the data truly come from a mixture. Notably, the same Stan model also <em>fits</em> the non-mixture data well.</p>
<div id="fiting-data-generated-by-a-non-mixture-process-with-a-mixture-model" class="section level4" number="2.2.2.1">
<h4><span class="header-section-number">2.2.2.1</span> Fiting data generated by a non-mixture process with a mixture model</h4>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>mix_ls <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">nrow</span>(mix_data),</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  <span class="at">nasalance =</span> mix_data<span class="sc">$</span>nasalance,</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>  <span class="at">E =</span> <span class="fu">as.integer</span>(mix_data<span class="sc">$</span>E)</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>mixm_mixd <span class="ot">&lt;-</span> mix_m<span class="sc">$</span><span class="fu">sample</span>(<span class="at">data =</span> mix_ls, <span class="at">parallel_chains =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>Parameter recovery:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_recover_hist</span>(</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>  <span class="at">x =</span> mixm_mixd<span class="sc">$</span><span class="fu">draws</span>(<span class="fu">c</span>(<span class="st">&quot;mu_oral&quot;</span>, <span class="st">&quot;sigma_oral&quot;</span>, <span class="st">&quot;mu_contact&quot;</span>, <span class="st">&quot;sigma_contact&quot;</span>, <span class="st">&quot;prob_nas&quot;</span>)),</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  <span class="at">true =</span> <span class="fu">unlist</span>(true)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="mixture-nasal_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>yrep <span class="ot">&lt;-</span> mixm_mixd<span class="sc">$</span><span class="fu">draws</span>(<span class="st">&quot;nasalance_rep&quot;</span>) <span class="sc">|&gt;</span> posterior<span class="sc">::</span><span class="fu">as_draws_matrix</span>()</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">ppc_dens_overlay_grouped</span>(<span class="at">y =</span> mix_data<span class="sc">$</span>nasalance, <span class="at">yrep =</span> yrep[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ], <span class="at">group =</span> mix_data<span class="sc">$</span>etymology)<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Mixture model on mixture data&quot;</span>)</span></code></pre></div>
<p><img src="mixture-nasal_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
<div id="fitting-non-mixture-data-with-a-mixture-model" class="section level4" number="2.2.2.2">
<h4><span class="header-section-number">2.2.2.2</span> Fitting non-mixture data with a mixture model</h4>
<p>Data not generated by a mixture model can be perfectly fit by a mixture model!</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>nonmix_ls <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">nrow</span>(nonmix_data),</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  <span class="at">nasalance =</span> nonmix_data<span class="sc">$</span>nasalance,</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  <span class="at">E =</span> <span class="fu">as.integer</span>(nonmix_data<span class="sc">$</span>E)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>)</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>mixm_nonmixd <span class="ot">&lt;-</span> mix_m<span class="sc">$</span><span class="fu">sample</span>(<span class="at">data =</span> nonmix_ls, <span class="at">parallel_chains =</span> <span class="dv">4</span>)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>yrep <span class="ot">&lt;-</span> mixm_nonmixd<span class="sc">$</span><span class="fu">draws</span>(<span class="st">&quot;nasalance_rep&quot;</span>) <span class="sc">|&gt;</span> posterior<span class="sc">::</span><span class="fu">as_draws_matrix</span>()</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">ppc_dens_overlay_grouped</span>(<span class="at">y =</span> nonmix_data<span class="sc">$</span>nasalance, <span class="at">yrep =</span> yrep[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ],<span class="at">group =</span> nonmix_data<span class="sc">$</span>etymology)<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Mixture model on non-mixture data&quot;</span>)</span></code></pre></div>
<p><img src="mixture-nasal_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="alternative-model-non-mixture-model" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Alternative model: non-mixture model</h2>
<p>This alternative Stan program replaces the Bernoulli mixture with a dedicated Beta for the nasalised class. Everything else remains the same. This model therefore embodies the (maybe unrealistic) hypothesis that historically nasalised aspirates form a coherent third distribution rather than a mixture of two.</p>
<p>Stan model:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co">#include beta2.stan</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span> = <span class="dv">1</span>&gt; N;</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  <span class="dt">vector</span>[N] nasalance;</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  <span class="dt">array</span>[N] <span class="dt">int</span>&lt;<span class="kw">lower</span> = <span class="dv">1</span>&gt; E;</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>}</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="kw">parameters</span> {</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span> = <span class="dv">0</span>, <span class="kw">upper</span> = <span class="dv">1</span>&gt; mu_contact;</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span> = <span class="dv">0</span>, <span class="kw">upper</span> = sqrt(mu_contact*(<span class="dv">1</span>-mu_contact))&gt; sigma_contact;</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span> = <span class="dv">0</span>, <span class="kw">upper</span> = <span class="dv">1</span> &gt; mu_oral;</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>= <span class="dv">0</span>, <span class="kw">upper</span> = sqrt(mu_oral*(<span class="dv">1</span>-mu_oral))&gt; sigma_oral;</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a> <span class="dt">real</span>&lt;<span class="kw">lower</span> = <span class="dv">0</span>, <span class="kw">upper</span> = <span class="dv">1</span>&gt; mu_nasalized;</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span> = <span class="dv">0</span>, <span class="kw">upper</span> = sqrt(mu_nasalized*(<span class="dv">1</span>-mu_nasalized))&gt; sigma_nasalized;</span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>}</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>  <span class="co">// priors for the task component</span></span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a>  <span class="kw">target +=</span> normal_lpdf(mu_contact | <span class="fl">0.6</span>, <span class="fl">0.2</span>);</span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a>  <span class="kw">target +=</span> normal_lpdf(mu_oral | <span class="fl">0.2</span>, <span class="fl">0.3</span>);</span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a>  <span class="kw">target +=</span> normal_lpdf(mu_nasalized | <span class="fl">0.2</span>, <span class="fl">0.3</span>);</span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a>  <span class="kw">target +=</span> normal_lpdf(sigma_oral | <span class="dv">0</span>, <span class="fl">0.3</span>);</span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a>  <span class="kw">target +=</span> normal_lpdf(sigma_contact | <span class="dv">0</span>, <span class="fl">0.3</span>);</span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a>  <span class="kw">target +=</span> normal_lpdf(sigma_nasalized | <span class="dv">0</span>, <span class="fl">0.3</span>);</span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a></span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a>  <span class="cf">for</span>(n <span class="cf">in</span> <span class="dv">1</span>:N){</span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a>    <span class="cf">if</span>(E[n] == <span class="dv">1</span>)  <span class="co">// contact</span></span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a>      <span class="kw">target +=</span>  beta2_lpdf(nasalance[n] | mu_contact, sigma_contact);</span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a>     <span class="cf">else</span> <span class="cf">if</span>(E[n] == <span class="dv">3</span>)  <span class="co">// oral</span></span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a>       <span class="kw">target +=</span> beta2_lpdf(nasalance[n] | mu_oral, sigma_oral);</span>
<span id="cb21-29"><a href="#cb21-29" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span>(E[n] == <span class="dv">2</span>) <span class="co">//nas</span></span>
<span id="cb21-30"><a href="#cb21-30" tabindex="-1"></a>       <span class="kw">target +=</span> beta2_lpdf(nasalance[n] | mu_nasalized, sigma_nasalized);</span>
<span id="cb21-31"><a href="#cb21-31" tabindex="-1"></a>  }</span>
<span id="cb21-32"><a href="#cb21-32" tabindex="-1"></a>}</span>
<span id="cb21-33"><a href="#cb21-33" tabindex="-1"></a><span class="kw">generated quantities</span> {</span>
<span id="cb21-34"><a href="#cb21-34" tabindex="-1"></a>  <span class="dt">vector</span>[N] log_lik;</span>
<span id="cb21-35"><a href="#cb21-35" tabindex="-1"></a>  <span class="dt">vector</span>[N] nasalance_rep;</span>
<span id="cb21-36"><a href="#cb21-36" tabindex="-1"></a></span>
<span id="cb21-37"><a href="#cb21-37" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span>:N) {</span>
<span id="cb21-38"><a href="#cb21-38" tabindex="-1"></a>    <span class="cf">if</span> (E[n] == <span class="dv">1</span>) {  <span class="co">// contact</span></span>
<span id="cb21-39"><a href="#cb21-39" tabindex="-1"></a>      log_lik[n] = beta2_lpdf(nasalance[n] | mu_contact, sigma_contact);</span>
<span id="cb21-40"><a href="#cb21-40" tabindex="-1"></a>      nasalance_rep[n] = beta2_rng(mu_contact, sigma_contact);</span>
<span id="cb21-41"><a href="#cb21-41" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (E[n] == <span class="dv">3</span>) {  <span class="co">// oral</span></span>
<span id="cb21-42"><a href="#cb21-42" tabindex="-1"></a>      log_lik[n] = beta2_lpdf(nasalance[n] | mu_oral, sigma_oral);</span>
<span id="cb21-43"><a href="#cb21-43" tabindex="-1"></a>      nasalance_rep[n] = beta2_rng(mu_oral, sigma_oral);</span>
<span id="cb21-44"><a href="#cb21-44" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (E[n] == <span class="dv">2</span>) {  <span class="co">// nasalized</span></span>
<span id="cb21-45"><a href="#cb21-45" tabindex="-1"></a>      log_lik[n] = beta2_lpdf(nasalance[n] | mu_nasalized, sigma_nasalized);</span>
<span id="cb21-46"><a href="#cb21-46" tabindex="-1"></a>      nasalance_rep[n] = beta2_rng(mu_nasalized, sigma_nasalized);</span>
<span id="cb21-47"><a href="#cb21-47" tabindex="-1"></a>    }</span>
<span id="cb21-48"><a href="#cb21-48" tabindex="-1"></a>  }</span>
<span id="cb21-49"><a href="#cb21-49" tabindex="-1"></a>}</span></code></pre></div>
<div id="fitting-mixture-and-non-mixture-data-with-a-non-mixture-model" class="section level3" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Fitting mixture and non-mixture data with a non-mixture model</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>nonmix_m <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="st">&quot;./nonmix.stan&quot;</span>)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>nonmixm_mixd <span class="ot">&lt;-</span> nonmix_m<span class="sc">$</span><span class="fu">sample</span>(<span class="at">data =</span> mix_ls, <span class="at">parallel_chains =</span> <span class="dv">4</span>)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>nonmixm_nonmixd <span class="ot">&lt;-</span> nonmix_m<span class="sc">$</span><span class="fu">sample</span>(<span class="at">data =</span> nonmix_ls, <span class="at">parallel_chains =</span> <span class="dv">4</span>)</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>nonmixm_mixd</span></code></pre></div>
<pre><code>        variable   mean median   sd  mad     q5    q95 rhat ess_bulk ess_tail
 lp__            223.15 223.47 1.75 1.56 219.71 225.34 1.00     1813     2718
 mu_contact        0.55   0.55 0.01 0.01   0.53   0.57 1.00     4616     2815
 sigma_contact     0.12   0.12 0.01 0.01   0.11   0.13 1.00     4713     2760
 mu_oral           0.16   0.16 0.01 0.01   0.14   0.17 1.00     4842     3373
 sigma_oral        0.10   0.10 0.01 0.01   0.08   0.11 1.00     4589     3023
 mu_nasalized      0.22   0.22 0.02 0.02   0.20   0.25 1.00     4331     2777
 sigma_nasalized   0.16   0.16 0.01 0.01   0.14   0.18 1.00     4025     2499
 log_lik[1]        1.12   1.12 0.07 0.07   1.00   1.24 1.00     5690     3494
 log_lik[2]        1.24   1.24 0.07 0.07   1.11   1.35 1.00     5416     3472
 log_lik[3]        0.84   0.84 0.08 0.08   0.70   0.97 1.00     5775     2994

 # showing 10 of 607 rows (change via &#39;max_rows&#39; argument or &#39;cmdstanr_max_rows&#39; option)</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>nonmixm_nonmixd</span></code></pre></div>
<pre><code>        variable   mean median   sd  mad     q5    q95 rhat ess_bulk ess_tail
 lp__            214.49 214.84 1.75 1.53 211.07 216.67 1.00     2090     2769
 mu_contact        0.55   0.55 0.01 0.01   0.53   0.57 1.00     4788     3191
 sigma_contact     0.12   0.12 0.01 0.01   0.11   0.13 1.00     4389     2846
 mu_oral           0.16   0.16 0.01 0.01   0.14   0.17 1.00     4649     3389
 sigma_oral        0.10   0.10 0.01 0.01   0.08   0.11 1.00     4673     2821
 mu_nasalized      0.23   0.23 0.02 0.02   0.21   0.26 1.00     4673     3239
 sigma_nasalized   0.18   0.18 0.01 0.01   0.16   0.20 1.00     3891     2795
 log_lik[1]        1.12   1.13 0.07 0.07   1.00   1.24 1.00     4995     3031
 log_lik[2]        1.24   1.24 0.07 0.07   1.12   1.35 1.00     4894     3185
 log_lik[3]        0.84   0.85 0.08 0.08   0.70   0.97 1.00     5106     3449

 # showing 10 of 607 rows (change via &#39;max_rows&#39; argument or &#39;cmdstanr_max_rows&#39; option)</code></pre>
<p>Recovery of the parameters of the non-mixture with the non-mixture model:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_recover_hist</span>(</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>  <span class="at">x =</span> nonmixm_nonmixd<span class="sc">$</span><span class="fu">draws</span>(<span class="fu">c</span>(<span class="st">&quot;mu_oral&quot;</span>, <span class="st">&quot;sigma_oral&quot;</span>, <span class="st">&quot;mu_contact&quot;</span>, <span class="st">&quot;sigma_contact&quot;</span>, <span class="st">&quot;mu_nasalized&quot;</span>, <span class="st">&quot;sigma_nasalized&quot;</span>)),</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>  <span class="at">true =</span> <span class="fu">unlist</span>(true2)</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="mixture-nasal_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>yrep_mixfit <span class="ot">&lt;-</span> nonmixm_mixd<span class="sc">$</span><span class="fu">draws</span>(<span class="st">&quot;nasalance_rep&quot;</span>) <span class="sc">|&gt;</span> posterior<span class="sc">::</span><span class="fu">as_draws_matrix</span>()</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="fu">ppc_dens_overlay_grouped</span>(</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>  <span class="at">y =</span> mix_data<span class="sc">$</span>nasalance,</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>  <span class="at">yrep =</span> yrep_mixfit[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ],  </span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>  <span class="at">group =</span> mix_data<span class="sc">$</span>etymology</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Non-mixture model on mixture data&quot;</span>)</span></code></pre></div>
<p><img src="mixture-nasal_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>yrep_nonmixfit <span class="ot">&lt;-</span> nonmixm_nonmixd<span class="sc">$</span><span class="fu">draws</span>(<span class="st">&quot;nasalance_rep&quot;</span>) <span class="sc">|&gt;</span> posterior<span class="sc">::</span><span class="fu">as_draws_matrix</span>()</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="fu">ppc_dens_overlay_grouped</span>(</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>  <span class="at">y =</span> nonmix_data<span class="sc">$</span>nasalance,</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>  <span class="at">yrep =</span> yrep_nonmixfit[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ],</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>  <span class="at">group =</span> nonmix_data<span class="sc">$</span>etymology</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Non-mixture model on non-mixture data&quot;</span>)</span></code></pre></div>
<p><img src="mixture-nasal_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Model comparison</h2>
<p>Model comparison via approximate leave-one-out cross-validation (LOO-CV) is rather inconclusive (in this small-data setting):</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>loo_mixm_mixd <span class="ot">&lt;-</span> <span class="fu">loo</span>(mixm_mixd<span class="sc">$</span><span class="fu">draws</span>(<span class="st">&quot;log_lik&quot;</span>))</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>loo_mixm_nonmixd <span class="ot">&lt;-</span> <span class="fu">loo</span>(mixm_nonmixd<span class="sc">$</span><span class="fu">draws</span>(<span class="st">&quot;log_lik&quot;</span>))</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>loo_nonmixm_mixd <span class="ot">&lt;-</span> <span class="fu">loo</span>(nonmixm_mixd<span class="sc">$</span><span class="fu">draws</span>(<span class="st">&quot;log_lik&quot;</span>))</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>loo_nonmixm_nonmixd <span class="ot">&lt;-</span> <span class="fu">loo</span>(nonmixm_nonmixd<span class="sc">$</span><span class="fu">draws</span>(<span class="st">&quot;log_lik&quot;</span>))</span></code></pre></div>
<div id="data-generated-by-a-mixture-process" class="section level3" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Data generated by a mixture process</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">loo_compare</span>(<span class="fu">list</span>(<span class="at">mixture_model =</span> loo_mixm_mixd,</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>                 <span class="at">non_mixture   =</span> loo_nonmixm_mixd))</span></code></pre></div>
<pre><code>              elpd_diff se_diff
mixture_model  0.0       0.0   
non_mixture   -8.1       4.1   </code></pre>
</div>
<div id="data-generated-by-a-nonmixture-process" class="section level3" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Data generated by a non‑mixture process</h3>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">loo_compare</span>(<span class="fu">list</span>(<span class="at">mixture_model =</span> loo_mixm_nonmixd,</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>                 <span class="at">non_mixture   =</span> loo_nonmixm_nonmixd))</span></code></pre></div>
<pre><code>              elpd_diff se_diff
non_mixture    0.0       0.0   
mixture_model -2.1       3.8   </code></pre>
<div class="note">
<p>Re-run everything changing both seeds to 123. What changes?</p>
</div>
</div>
</div>
<div id="hierarchical-extensions" class="section level2" number="2.5">
<h2><span class="header-section-number">2.5</span> Hierarchical extensions</h2>
<p>Real speakers differ in how faithfully they produce nasalised aspirates. The next two Stan programs introduce <strong>speaker-level group effects</strong> on the mixture weight and, in the final version, also on the contact/oral means via a Cholesky-factor LKJ prior. The high-level structure is unchanged.</p>
<div id="subject-level-adjustments-for-the-mixture-weight" class="section level3" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> Subject level adjustments for the mixture weight</h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="co">#include beta2.stan</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span> = <span class="dv">1</span>&gt; N;</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>  <span class="dt">vector</span>[N] nasalance;</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>  <span class="dt">array</span>[N] <span class="dt">int</span>&lt;<span class="kw">lower</span> = <span class="dv">1</span>&gt; E;</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>  <span class="dt">array</span>[N] <span class="dt">int</span>&lt;<span class="kw">lower</span> = <span class="dv">1</span>&gt; speaker;</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span> = <span class="dv">1</span>&gt; N_speaker;</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>}</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a><span class="kw">parameters</span> {</span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span> = <span class="dv">0</span>, <span class="kw">upper</span> = <span class="dv">1</span>&gt; mu_contact;</span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span> = <span class="dv">0</span>, <span class="kw">upper</span> = sqrt(mu_contact*(<span class="dv">1</span>-mu_contact))&gt; sigma_contact;</span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span> = <span class="dv">0</span>, <span class="kw">upper</span> = <span class="dv">1</span> &gt; mu_oral;</span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>= <span class="dv">0</span>, <span class="kw">upper</span> = sqrt(mu_oral*(<span class="dv">1</span>-mu_oral))&gt; sigma_oral;</span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a>  <span class="co">// now it&#39;s log odds</span></span>
<span id="cb35-16"><a href="#cb35-16" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span> = <span class="dv">0</span>, <span class="kw">upper</span> = <span class="dv">1</span>&gt; av_prob_nas;</span>
<span id="cb35-17"><a href="#cb35-17" tabindex="-1"></a></span>
<span id="cb35-18"><a href="#cb35-18" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span> = <span class="dv">0</span>&gt;  tau_u;</span>
<span id="cb35-19"><a href="#cb35-19" tabindex="-1"></a>  <span class="dt">vector</span>[N_speaker] z_u;</span>
<span id="cb35-20"><a href="#cb35-20" tabindex="-1"></a>}</span>
<span id="cb35-21"><a href="#cb35-21" tabindex="-1"></a><span class="kw">transformed parameters</span> {</span>
<span id="cb35-22"><a href="#cb35-22" tabindex="-1"></a>  <span class="dt">vector</span>[N_speaker] u;</span>
<span id="cb35-23"><a href="#cb35-23" tabindex="-1"></a>  u = tau_u * z_u;</span>
<span id="cb35-24"><a href="#cb35-24" tabindex="-1"></a>}</span>
<span id="cb35-25"><a href="#cb35-25" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb35-26"><a href="#cb35-26" tabindex="-1"></a>  <span class="co">// priors for the task component</span></span>
<span id="cb35-27"><a href="#cb35-27" tabindex="-1"></a>  <span class="kw">target +=</span> normal_lpdf(mu_contact | <span class="fl">0.6</span>, <span class="fl">0.2</span>);</span>
<span id="cb35-28"><a href="#cb35-28" tabindex="-1"></a>  <span class="kw">target +=</span> normal_lpdf(mu_oral | <span class="fl">0.2</span>, <span class="fl">0.3</span>);</span>
<span id="cb35-29"><a href="#cb35-29" tabindex="-1"></a>  <span class="kw">target +=</span> normal_lpdf(sigma_oral | <span class="dv">0</span>, <span class="fl">0.3</span>);</span>
<span id="cb35-30"><a href="#cb35-30" tabindex="-1"></a>  <span class="kw">target +=</span> normal_lpdf(sigma_contact | <span class="dv">0</span>, <span class="fl">0.3</span>);</span>
<span id="cb35-31"><a href="#cb35-31" tabindex="-1"></a></span>
<span id="cb35-32"><a href="#cb35-32" tabindex="-1"></a>  <span class="kw">target +=</span> std_normal_lpdf(z_u);</span>
<span id="cb35-33"><a href="#cb35-33" tabindex="-1"></a>  <span class="kw">target +=</span> normal_lpdf(tau_u | <span class="dv">0</span>, <span class="dv">2</span>);</span>
<span id="cb35-34"><a href="#cb35-34" tabindex="-1"></a>  </span>
<span id="cb35-35"><a href="#cb35-35" tabindex="-1"></a>  <span class="kw">target +=</span> beta_lpdf(av_prob_nas | <span class="dv">3</span>, <span class="dv">10</span>);</span>
<span id="cb35-36"><a href="#cb35-36" tabindex="-1"></a></span>
<span id="cb35-37"><a href="#cb35-37" tabindex="-1"></a>  <span class="cf">for</span>(n <span class="cf">in</span> <span class="dv">1</span>:N){</span>
<span id="cb35-38"><a href="#cb35-38" tabindex="-1"></a>    <span class="cf">if</span>(E[n] == <span class="dv">1</span>)  <span class="co">// contact</span></span>
<span id="cb35-39"><a href="#cb35-39" tabindex="-1"></a>      <span class="kw">target +=</span>  beta2_lpdf(nasalance[n] | mu_contact, sigma_contact);</span>
<span id="cb35-40"><a href="#cb35-40" tabindex="-1"></a>     <span class="cf">else</span> <span class="cf">if</span>(E[n] == <span class="dv">3</span>)  <span class="co">// oral</span></span>
<span id="cb35-41"><a href="#cb35-41" tabindex="-1"></a>       <span class="kw">target +=</span> beta2_lpdf(nasalance[n] | mu_oral, sigma_oral);</span>
<span id="cb35-42"><a href="#cb35-42" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span>(E[n] == <span class="dv">2</span>) { <span class="co">//nas</span></span>
<span id="cb35-43"><a href="#cb35-43" tabindex="-1"></a>       <span class="dt">real</span> logodds_nas = logit(av_prob_nas) + u[speaker[n]];</span>
<span id="cb35-44"><a href="#cb35-44" tabindex="-1"></a>       <span class="kw">target +=</span> log_sum_exp(log_inv_logit(logodds_nas) +</span>
<span id="cb35-45"><a href="#cb35-45" tabindex="-1"></a>                  beta2_lpdf(nasalance[n] | mu_contact, sigma_contact),</span>
<span id="cb35-46"><a href="#cb35-46" tabindex="-1"></a>                  log1m_inv_logit(logodds_nas)+</span>
<span id="cb35-47"><a href="#cb35-47" tabindex="-1"></a>                  beta2_lpdf(nasalance[n] | mu_oral, sigma_oral));</span>
<span id="cb35-48"><a href="#cb35-48" tabindex="-1"></a>       }</span>
<span id="cb35-49"><a href="#cb35-49" tabindex="-1"></a>  }</span>
<span id="cb35-50"><a href="#cb35-50" tabindex="-1"></a>}</span>
<span id="cb35-51"><a href="#cb35-51" tabindex="-1"></a><span class="kw">generated quantities</span> {</span>
<span id="cb35-52"><a href="#cb35-52" tabindex="-1"></a>  <span class="dt">vector</span>[N] log_lik;</span>
<span id="cb35-53"><a href="#cb35-53" tabindex="-1"></a>  <span class="dt">vector</span>[N] nasalance_rep;</span>
<span id="cb35-54"><a href="#cb35-54" tabindex="-1"></a>  <span class="dt">vector</span>[N_speaker] prob_nas_speaker = inv_logit(logit(av_prob_nas) + u);</span>
<span id="cb35-55"><a href="#cb35-55" tabindex="-1"></a>  </span>
<span id="cb35-56"><a href="#cb35-56" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span>:N) {</span>
<span id="cb35-57"><a href="#cb35-57" tabindex="-1"></a>    <span class="cf">if</span> (E[n] == <span class="dv">1</span>) {  <span class="co">// contact</span></span>
<span id="cb35-58"><a href="#cb35-58" tabindex="-1"></a>      log_lik[n] = beta2_lpdf(nasalance[n] | mu_contact, sigma_contact);</span>
<span id="cb35-59"><a href="#cb35-59" tabindex="-1"></a>      nasalance_rep[n] = beta2_rng(mu_contact, sigma_contact);</span>
<span id="cb35-60"><a href="#cb35-60" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (E[n] == <span class="dv">3</span>) {  <span class="co">// oral</span></span>
<span id="cb35-61"><a href="#cb35-61" tabindex="-1"></a>      log_lik[n] = beta2_lpdf(nasalance[n] | mu_oral, sigma_oral);</span>
<span id="cb35-62"><a href="#cb35-62" tabindex="-1"></a>      nasalance_rep[n] = beta2_rng(mu_oral, sigma_oral);</span>
<span id="cb35-63"><a href="#cb35-63" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (E[n] == <span class="dv">2</span>) { <span class="co">// nas</span></span>
<span id="cb35-64"><a href="#cb35-64" tabindex="-1"></a>      <span class="dt">real</span> logodds_nas = logit(av_prob_nas) + u[speaker[n]];</span>
<span id="cb35-65"><a href="#cb35-65" tabindex="-1"></a>      <span class="dt">real</span> theta = inv_logit(logodds_nas);</span>
<span id="cb35-66"><a href="#cb35-66" tabindex="-1"></a>      log_lik[n] = log_sum_exp(</span>
<span id="cb35-67"><a href="#cb35-67" tabindex="-1"></a>        log(theta) + beta2_lpdf(nasalance[n] | mu_contact, sigma_contact),</span>
<span id="cb35-68"><a href="#cb35-68" tabindex="-1"></a>        log1m(theta) + beta2_lpdf(nasalance[n] | mu_oral, sigma_oral)</span>
<span id="cb35-69"><a href="#cb35-69" tabindex="-1"></a>      );</span>
<span id="cb35-70"><a href="#cb35-70" tabindex="-1"></a>      <span class="cf">if</span> (bernoulli_rng(theta) == <span class="dv">1</span>)</span>
<span id="cb35-71"><a href="#cb35-71" tabindex="-1"></a>        nasalance_rep[n] = beta2_rng(mu_contact, sigma_contact);</span>
<span id="cb35-72"><a href="#cb35-72" tabindex="-1"></a>      <span class="cf">else</span></span>
<span id="cb35-73"><a href="#cb35-73" tabindex="-1"></a>        nasalance_rep[n] = beta2_rng(mu_oral, sigma_oral);</span>
<span id="cb35-74"><a href="#cb35-74" tabindex="-1"></a>    }</span>
<span id="cb35-75"><a href="#cb35-75" tabindex="-1"></a>  }</span>
<span id="cb35-76"><a href="#cb35-76" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>mix_s_m <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="st">&quot;./mix_s.stan&quot;</span>)</span></code></pre></div>
<p>We first verify that we can recover the generating parameters. <span class="citation">(A complete pipeline would also include SBC, which we omit for brevity: Talts et al. 2018; Modrák et al. 2023)</span>. We skip this step here.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>nas_ls <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">N =</span> <span class="fu">nrow</span>(nas_data),</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>               <span class="at">nasalance =</span> nas_data<span class="sc">$</span>nasalance,</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>               <span class="at">E =</span> nas_data<span class="sc">$</span>E,</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>               <span class="at">speaker =</span> nas_data<span class="sc">$</span>speaker,</span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>               <span class="at">N_speaker =</span> <span class="fu">max</span>(nas_data<span class="sc">$</span>speaker))</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a>               </span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a>nas_mix <span class="ot">&lt;-</span> mix_s_m<span class="sc">$</span><span class="fu">sample</span>(<span class="at">data =</span> nas_ls, <span class="at">parallel_chains =</span> <span class="dv">4</span>)</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>yrep <span class="ot">&lt;-</span> nas_mix<span class="sc">$</span><span class="fu">draws</span>(<span class="st">&quot;nasalance_rep&quot;</span>) <span class="sc">|&gt;</span> posterior<span class="sc">::</span><span class="fu">as_draws_matrix</span>()</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a><span class="fu">ppc_dens_overlay_grouped</span>(</span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>  <span class="at">y =</span> nas_data<span class="sc">$</span>nasalance,</span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a>  <span class="at">yrep =</span> yrep[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ],</span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a>  <span class="at">group =</span> nas_data<span class="sc">$</span>etymology</span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Real data&quot;</span>)</span></code></pre></div>
<p><img src="mixture-nasal_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>yrep_mat <span class="ot">&lt;-</span> yrep[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># assuming yrep is already created</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>n_draws <span class="ot">&lt;-</span> <span class="fu">nrow</span>(yrep_mat)</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a><span class="co"># Build long dataframe from yrep and attach metadata</span></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>yrep_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(yrep_mat)) <span class="sc">|&gt;</span></span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">paste0</span>(<span class="st">&quot;draw&quot;</span>, <span class="dv">1</span><span class="sc">:</span>n_draws)) <span class="sc">|&gt;</span></span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>    <span class="at">obs =</span> nas_data<span class="sc">$</span>nasalance,</span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>    <span class="at">speaker =</span> nas_data<span class="sc">$</span>speaker,</span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>    <span class="at">etymology =</span> nas_data<span class="sc">$</span>etymology</span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;draw&quot;</span>),</span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;draw&quot;</span>,</span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;yrep&quot;</span></span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a>  )</span>
<span id="cb39-17"><a href="#cb39-17" tabindex="-1"></a></span>
<span id="cb39-18"><a href="#cb39-18" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb39-19"><a href="#cb39-19" tabindex="-1"></a><span class="fu">ggplot</span>(yrep_df, <span class="fu">aes</span>(<span class="at">x =</span> etymology, <span class="at">y =</span> yrep, <span class="at">fill =</span> etymology)) <span class="sc">+</span></span>
<span id="cb39-20"><a href="#cb39-20" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">scale =</span> <span class="st">&quot;width&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-21"><a href="#cb39-21" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> obs), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb39-22"><a href="#cb39-22" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> speaker, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-23"><a href="#cb39-23" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Posterior predictive violins per speaker and etymology&quot;</span>,</span>
<span id="cb39-24"><a href="#cb39-24" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Etymology&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Nasalance&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-25"><a href="#cb39-25" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb39-26"><a href="#cb39-26" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="mixture-nasal_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>Are there subjects who nasalize more?</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="fu">mcmc_intervals</span>(nas_mix<span class="sc">$</span><span class="fu">draws</span>(<span class="st">&quot;prob_nas_speaker&quot;</span>))</span></code></pre></div>
<p><img src="mixture-nasal_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<div class="note">
<p>Add an analogous parameter <code>w</code> which modulates the probability of nasalization by <code>root</code>. Which roots are most likely to be nasalized?</p>
</div>
</div>
<div id="subject-level-adjustments-for-the-mixture-weight-and-mean-nasalization." class="section level3" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> Subject level adjustments for the mixture weight and mean nasalization.</h3>
<p>A more comprehensive hierarchical model allows <code>mu_contact</code> and <code>mu_oral</code><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> to vary by speaker and/or by root.</p>
<p>Stan code:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="co">#include beta2.stan</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span> = <span class="dv">1</span>&gt; N;</span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>  <span class="dt">vector</span>[N] nasalance;</span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>  <span class="dt">array</span>[N] <span class="dt">int</span>&lt;<span class="kw">lower</span> = <span class="dv">1</span>&gt; E;</span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>  <span class="dt">array</span>[N] <span class="dt">int</span>&lt;<span class="kw">lower</span> = <span class="dv">1</span>&gt; speaker;</span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span> = <span class="dv">1</span>&gt; N_speaker;</span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a>}</span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a><span class="kw">parameters</span> {</span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span> = <span class="dv">0</span>, <span class="kw">upper</span> = <span class="dv">1</span>&gt; mu_contact;</span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span> = <span class="dv">0</span>, <span class="kw">upper</span> = sqrt(mu_contact*(<span class="dv">1</span>-mu_contact))&gt; sigma_contact;</span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span> = <span class="dv">0</span>, <span class="kw">upper</span> = <span class="dv">1</span> &gt; mu_oral;</span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>= <span class="dv">0</span>, <span class="kw">upper</span> = sqrt(mu_oral*(<span class="dv">1</span>-mu_oral))&gt; sigma_oral;</span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" tabindex="-1"></a>  <span class="co">// now it&#39;s log odds</span></span>
<span id="cb41-16"><a href="#cb41-16" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span> = <span class="dv">0</span>, <span class="kw">upper</span> = <span class="dv">1</span>&gt; av_prob_nas;</span>
<span id="cb41-17"><a href="#cb41-17" tabindex="-1"></a></span>
<span id="cb41-18"><a href="#cb41-18" tabindex="-1"></a> <span class="dt">vector</span>&lt;<span class="kw">lower</span> = <span class="dv">0</span>&gt;[<span class="dv">3</span>]  tau_u;</span>
<span id="cb41-19"><a href="#cb41-19" tabindex="-1"></a>  <span class="dt">matrix</span>[<span class="dv">3</span>, N_speaker] z_u;</span>
<span id="cb41-20"><a href="#cb41-20" tabindex="-1"></a>  <span class="dt">cholesky_factor_corr</span>[<span class="dv">3</span>] L_u;</span>
<span id="cb41-21"><a href="#cb41-21" tabindex="-1"></a>}</span>
<span id="cb41-22"><a href="#cb41-22" tabindex="-1"></a><span class="kw">transformed parameters</span> {</span>
<span id="cb41-23"><a href="#cb41-23" tabindex="-1"></a>  <span class="dt">matrix</span>[N_speaker, <span class="dv">3</span>] u;</span>
<span id="cb41-24"><a href="#cb41-24" tabindex="-1"></a>  u = (diag_pre_multiply(tau_u, L_u) * z_u)&#39;;</span>
<span id="cb41-25"><a href="#cb41-25" tabindex="-1"></a>}</span>
<span id="cb41-26"><a href="#cb41-26" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb41-27"><a href="#cb41-27" tabindex="-1"></a>  <span class="co">// priors for the task component</span></span>
<span id="cb41-28"><a href="#cb41-28" tabindex="-1"></a>  <span class="kw">target +=</span> normal_lpdf(mu_contact | <span class="fl">0.6</span>, <span class="fl">0.2</span>);</span>
<span id="cb41-29"><a href="#cb41-29" tabindex="-1"></a>  <span class="kw">target +=</span> normal_lpdf(mu_oral | <span class="fl">0.2</span>, <span class="fl">0.3</span>);</span>
<span id="cb41-30"><a href="#cb41-30" tabindex="-1"></a>  <span class="kw">target +=</span> normal_lpdf(sigma_oral | <span class="dv">0</span>, <span class="fl">0.3</span>);</span>
<span id="cb41-31"><a href="#cb41-31" tabindex="-1"></a>  <span class="kw">target +=</span> normal_lpdf(sigma_contact | <span class="dv">0</span>, <span class="fl">0.3</span>);</span>
<span id="cb41-32"><a href="#cb41-32" tabindex="-1"></a></span>
<span id="cb41-33"><a href="#cb41-33" tabindex="-1"></a>  <span class="kw">target +=</span> lkj_corr_cholesky_lpdf(L_u | <span class="dv">2</span>);</span>
<span id="cb41-34"><a href="#cb41-34" tabindex="-1"></a>  <span class="kw">target +=</span> std_normal_lpdf(to_vector(z_u));</span>
<span id="cb41-35"><a href="#cb41-35" tabindex="-1"></a>  <span class="kw">target +=</span> normal_lpdf(tau_u | <span class="dv">0</span>, <span class="dv">2</span>);</span>
<span id="cb41-36"><a href="#cb41-36" tabindex="-1"></a>  </span>
<span id="cb41-37"><a href="#cb41-37" tabindex="-1"></a>  <span class="kw">target +=</span> beta_lpdf(av_prob_nas | <span class="dv">3</span>, <span class="dv">10</span>);</span>
<span id="cb41-38"><a href="#cb41-38" tabindex="-1"></a></span>
<span id="cb41-39"><a href="#cb41-39" tabindex="-1"></a>  <span class="cf">for</span>(n <span class="cf">in</span> <span class="dv">1</span>:N){</span>
<span id="cb41-40"><a href="#cb41-40" tabindex="-1"></a>      <span class="dt">real</span> mu_c_adj = inv_logit(logit(mu_contact) + u[speaker[n], <span class="dv">1</span>]);</span>
<span id="cb41-41"><a href="#cb41-41" tabindex="-1"></a>      <span class="dt">real</span> mu_o_adj = inv_logit(logit(mu_oral) + u[speaker[n], <span class="dv">3</span>]);</span>
<span id="cb41-42"><a href="#cb41-42" tabindex="-1"></a>      <span class="cf">if</span>(E[n] == <span class="dv">1</span>)  <span class="co">// contact</span></span>
<span id="cb41-43"><a href="#cb41-43" tabindex="-1"></a>      <span class="kw">target +=</span>  beta2_lpdf(nasalance[n] | mu_c_adj, sigma_contact);</span>
<span id="cb41-44"><a href="#cb41-44" tabindex="-1"></a>     <span class="cf">else</span> <span class="cf">if</span>(E[n] == <span class="dv">3</span>)  <span class="co">// oral</span></span>
<span id="cb41-45"><a href="#cb41-45" tabindex="-1"></a>       <span class="kw">target +=</span> beta2_lpdf(nasalance[n] | mu_o_adj, sigma_oral);</span>
<span id="cb41-46"><a href="#cb41-46" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span>(E[n] == <span class="dv">2</span>) { <span class="co">//nas</span></span>
<span id="cb41-47"><a href="#cb41-47" tabindex="-1"></a>       <span class="dt">real</span> logodds_nas = logit(av_prob_nas) + u[speaker[n], <span class="dv">2</span>];</span>
<span id="cb41-48"><a href="#cb41-48" tabindex="-1"></a>       <span class="kw">target +=</span> log_sum_exp(log_inv_logit(logodds_nas) +</span>
<span id="cb41-49"><a href="#cb41-49" tabindex="-1"></a>                  beta2_lpdf(nasalance[n] | mu_c_adj, sigma_contact),</span>
<span id="cb41-50"><a href="#cb41-50" tabindex="-1"></a>                  log1m_inv_logit(logodds_nas)+</span>
<span id="cb41-51"><a href="#cb41-51" tabindex="-1"></a>                  beta2_lpdf(nasalance[n] | mu_o_adj, sigma_oral));</span>
<span id="cb41-52"><a href="#cb41-52" tabindex="-1"></a>       }</span>
<span id="cb41-53"><a href="#cb41-53" tabindex="-1"></a>  }</span>
<span id="cb41-54"><a href="#cb41-54" tabindex="-1"></a>}</span>
<span id="cb41-55"><a href="#cb41-55" tabindex="-1"></a><span class="kw">generated quantities</span> {</span>
<span id="cb41-56"><a href="#cb41-56" tabindex="-1"></a>  <span class="dt">vector</span>[N] log_lik;</span>
<span id="cb41-57"><a href="#cb41-57" tabindex="-1"></a>  <span class="dt">vector</span>[N] nasalance_rep;</span>
<span id="cb41-58"><a href="#cb41-58" tabindex="-1"></a>  <span class="dt">vector</span>[N_speaker] prob_nas_speaker = inv_logit(logit(av_prob_nas) + u[,<span class="dv">3</span>]);</span>
<span id="cb41-59"><a href="#cb41-59" tabindex="-1"></a>  </span>
<span id="cb41-60"><a href="#cb41-60" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span>:N) {</span>
<span id="cb41-61"><a href="#cb41-61" tabindex="-1"></a>    <span class="dt">real</span> mu_c_adj = inv_logit(logit(mu_contact) + u[speaker[n], <span class="dv">1</span>]);</span>
<span id="cb41-62"><a href="#cb41-62" tabindex="-1"></a>     <span class="dt">real</span> mu_o_adj = inv_logit(logit(mu_oral) + u[speaker[n], <span class="dv">3</span>]);</span>
<span id="cb41-63"><a href="#cb41-63" tabindex="-1"></a>        <span class="cf">if</span> (E[n] == <span class="dv">1</span>) {  <span class="co">// contact</span></span>
<span id="cb41-64"><a href="#cb41-64" tabindex="-1"></a>      log_lik[n] = beta2_lpdf(nasalance[n] | mu_c_adj, sigma_contact);</span>
<span id="cb41-65"><a href="#cb41-65" tabindex="-1"></a>      nasalance_rep[n] = beta2_rng(mu_c_adj, sigma_contact);</span>
<span id="cb41-66"><a href="#cb41-66" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (E[n] == <span class="dv">3</span>) {  <span class="co">// oral</span></span>
<span id="cb41-67"><a href="#cb41-67" tabindex="-1"></a>      log_lik[n] = beta2_lpdf(nasalance[n] | mu_o_adj, sigma_oral);</span>
<span id="cb41-68"><a href="#cb41-68" tabindex="-1"></a>      nasalance_rep[n] = beta2_rng(mu_o_adj, sigma_oral);</span>
<span id="cb41-69"><a href="#cb41-69" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (E[n] == <span class="dv">2</span>) { <span class="co">// nas</span></span>
<span id="cb41-70"><a href="#cb41-70" tabindex="-1"></a>      <span class="dt">real</span> logodds_nas = logit(av_prob_nas) + u[speaker[n], <span class="dv">3</span>];</span>
<span id="cb41-71"><a href="#cb41-71" tabindex="-1"></a>      <span class="dt">real</span> theta = inv_logit(logodds_nas);</span>
<span id="cb41-72"><a href="#cb41-72" tabindex="-1"></a>      log_lik[n] = log_sum_exp(</span>
<span id="cb41-73"><a href="#cb41-73" tabindex="-1"></a>        log(theta) + beta2_lpdf(nasalance[n] | mu_c_adj, sigma_contact),</span>
<span id="cb41-74"><a href="#cb41-74" tabindex="-1"></a>        log1m(theta) + beta2_lpdf(nasalance[n] | mu_o_adj, sigma_oral)</span>
<span id="cb41-75"><a href="#cb41-75" tabindex="-1"></a>      );</span>
<span id="cb41-76"><a href="#cb41-76" tabindex="-1"></a>      <span class="cf">if</span> (bernoulli_rng(theta) == <span class="dv">1</span>)</span>
<span id="cb41-77"><a href="#cb41-77" tabindex="-1"></a>        nasalance_rep[n] = beta2_rng(mu_c_adj, sigma_contact);</span>
<span id="cb41-78"><a href="#cb41-78" tabindex="-1"></a>      <span class="cf">else</span></span>
<span id="cb41-79"><a href="#cb41-79" tabindex="-1"></a>        nasalance_rep[n] = beta2_rng(mu_o_adj, sigma_oral);</span>
<span id="cb41-80"><a href="#cb41-80" tabindex="-1"></a>    }</span>
<span id="cb41-81"><a href="#cb41-81" tabindex="-1"></a>  }</span>
<span id="cb41-82"><a href="#cb41-82" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>mix_s2_m <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="st">&quot;./mix_s2.stan&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>nas2_mix <span class="ot">&lt;-</span> mix_s2_m<span class="sc">$</span><span class="fu">sample</span>(<span class="at">data =</span> nas_ls, <span class="at">parallel_chains =</span> <span class="dv">4</span>)</span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>nas2_mix</span></code></pre></div>
<pre><code>      variable   mean median   sd  mad     q5    q95 rhat ess_bulk ess_tail
 lp__          546.59 546.95 6.15 6.29 536.10 556.04 1.00      955     1777
 mu_contact      0.54   0.54 0.02 0.02   0.51   0.57 1.00     2771     2464
 sigma_contact   0.13   0.13 0.01 0.01   0.11   0.14 1.00     3288     2848
 mu_oral         0.16   0.16 0.01 0.01   0.15   0.18 1.00     1856     1983
 sigma_oral      0.08   0.08 0.00 0.00   0.08   0.09 1.00     5449     2789
 av_prob_nas     0.15   0.14 0.06 0.05   0.07   0.26 1.00     2133     2315
 tau_u[1]        0.17   0.16 0.09 0.08   0.04   0.32 1.00     1266     1301
 tau_u[2]        1.68   1.57 0.63 0.54   0.89   2.87 1.00     1718     2197
 tau_u[3]        0.19   0.18 0.06 0.05   0.12   0.30 1.00     1879     2438
 z_u[1,1]       -0.52  -0.54 0.87 0.83  -1.93   0.91 1.00     2513     3060

 # showing 10 of 1493 rows (change via &#39;max_rows&#39; argument or &#39;cmdstanr_max_rows&#39; option)</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>yrep <span class="ot">&lt;-</span> nas2_mix<span class="sc">$</span><span class="fu">draws</span>(<span class="st">&quot;nasalance_rep&quot;</span>) <span class="sc">|&gt;</span> posterior<span class="sc">::</span><span class="fu">as_draws_matrix</span>()</span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a><span class="fu">ppc_dens_overlay_grouped</span>(</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>  <span class="at">y =</span> nas_data<span class="sc">$</span>nasalance,</span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a>  <span class="at">yrep =</span> yrep[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ],</span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>  <span class="at">group =</span> nas_data<span class="sc">$</span>etymology</span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Real data with the more complex model&quot;</span>)</span></code></pre></div>
<p><img src="mixture-nasal_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<div class="note">
<p>Consider additional posterior predictive checks.</p>
</div>
<div class="notes">
<p>Consider simulating data.</p>
</div>
<div class="note">
<p>Is the hierarchical mixture model preferable to a hierarchical non-mixture alternative?</p>
</div>
</div>
</div>
</div>
<div id="conclusions" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Conclusions</h1>
<ul>
<li><strong>Visual similarity is deceptive.</strong> Simulated mixture and non-mixture data look almost identical.</li>
<li><strong>Model comparison alone can be inconclusive</strong> at the current sample size: both mixture and non-mixture models achieve very similar LOO‑CV scores on either data-generating process.</li>
<li><strong>Speaker-level effects matter.</strong> Allowing the mixture weight to vary by speaker reveals substantial individual differences.</li>
<li><strong>Domain knowledge remains crucial.</strong> The structure of the model should be informed by theory.</li>
</ul>
<hr />
</div>
<div id="session-info" class="section level1 unnumbered">
<h1>Session info</h1>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.5.0 (2025-04-11)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 22.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0  LAPACK version 3.10.0

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=nl_NL.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=nl_NL.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=nl_NL.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=nl_NL.UTF-8 LC_IDENTIFICATION=C       

time zone: Europe/Amsterdam
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] loo_2.8.0        ggplot2_3.5.2    brms_2.22.0      Rcpp_1.0.14     
[5] bayesplot_1.12.0 posterior_1.6.1  cmdstanr_0.9.0   tidytable_0.11.2

loaded via a namespace (and not attached):
 [1] bridgesampling_1.1-5 tensorA_0.36.2.1     sass_0.4.10         
 [4] generics_0.1.4       stringi_1.8.7        lattice_0.22-5      
 [7] digest_0.6.37        magrittr_2.0.3       evaluate_1.0.3      
[10] grid_4.5.0           RColorBrewer_1.1-3   bookdown_0.43       
[13] mvtnorm_1.3-3        fastmap_1.2.0        jsonlite_2.0.0      
[16] Matrix_1.7-3         processx_3.8.6       backports_1.5.0     
[19] ps_1.9.1             Brobdingnag_1.2-9    scales_1.4.0        
[22] jquerylib_0.1.4      abind_1.4-8          cli_3.6.5           
[25] rlang_1.1.6          withr_3.0.2          cachem_1.1.0        
[28] yaml_2.3.10          tools_4.5.0          parallel_4.5.0      
[31] rstantools_2.4.0     coda_0.19-4.1        checkmate_2.3.2     
[34] dplyr_1.1.4          vctrs_0.6.5          R6_2.6.1            
[37] matrixStats_1.5.0    lifecycle_1.0.4      stringr_1.5.1       
[40] pkgconfig_2.0.3      RcppParallel_5.1.10  pillar_1.10.2       
[43] bslib_0.9.0          gtable_0.3.6         data.table_1.17.0   
[46] glue_1.8.0           xfun_0.52            tibble_3.3.0        
[49] tidyselect_1.2.1     rstudioapi_0.17.1    knitr_1.50          
[52] farver_2.1.2         nlme_3.1-168         htmltools_0.5.8.1   
[55] rmarkdown_2.29       compiler_4.5.0       distributional_0.5.0</code></pre>
<p>I used R <span class="citation">(Version 4.5.0; R Core Team 2025)</span> and the R-packages <em>bayesplot</em> <span class="citation">(Version 1.12.0; Gabry and Mahr 2025)</span>, <em>brms</em> <span class="citation">(Version 2.22.0; Bürkner 2024)</span>, <em>cmdstanr</em> <span class="citation">(Version 0.9.0; Gabry et al. 2025)</span>, <em>ggplot2</em> <span class="citation">(Version 3.5.2; Wickham et al. 2025)</span>, <em>loo</em> <span class="citation">(Version 2.8.0; Vehtari et al. 2024)</span>, <em>posterior</em> <span class="citation">(Version 1.6.1; Bürkner et al. 2025)</span>, <em>Rcpp</em> <span class="citation">(Version 1.0.14; Eddelbuettel et al. 2025)</span> and <em>tidytable</em> <span class="citation">(Version 0.11.2; Fairbanks 2024)</span> for all our analyses.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-R-brms" class="csl-entry">
Bürkner, Paul-Christian. 2024. <em>Brms: Bayesian Regression Models Using Stan</em>. <a href="https://github.com/paul-buerkner/brms">https://github.com/paul-buerkner/brms</a>.
</div>
<div id="ref-R-posterior" class="csl-entry">
Bürkner, Paul-Christian, Jonah Gabry, Matthew Kay, and Aki Vehtari. 2025. <em>Posterior: Tools for Working with Posterior Distributions</em>. <a href="https://mc-stan.org/posterior/">https://mc-stan.org/posterior/</a>.
</div>
<div id="ref-R-Rcpp" class="csl-entry">
Eddelbuettel, Dirk, Romain Francois, JJ Allaire, Kevin Ushey, Qiang Kou, Nathan Russell, Iñaki Ucar, Doug Bates, and John Chambers. 2025. <em>Rcpp: Seamless r and c++ Integration</em>. <a href="https://www.rcpp.org">https://www.rcpp.org</a>.
</div>
<div id="ref-R-tidytable" class="csl-entry">
Fairbanks, Mark. 2024. <em>Tidytable: Tidy Interface to Data.table</em>. <a href="https://markfairbanks.github.io/tidytable/">https://markfairbanks.github.io/tidytable/</a>.
</div>
<div id="ref-R-cmdstanr" class="csl-entry">
Gabry, Jonah, Rok Češnovar, Andrew Johnson, and Steve Bronder. 2025. <em>Cmdstanr: R Interface to CmdStan</em>. <a href="https://mc-stan.org/cmdstanr/">https://mc-stan.org/cmdstanr/</a>.
</div>
<div id="ref-R-bayesplot" class="csl-entry">
Gabry, Jonah, and Tristan Mahr. 2025. <em>Bayesplot: Plotting for Bayesian Models</em>. <a href="https://mc-stan.org/bayesplot/">https://mc-stan.org/bayesplot/</a>.
</div>
<div id="ref-ModrakEtAl2023" class="csl-entry">
Modrák, Martin, Angie H. Moon, Shinyoung Kim, Paul-Christian Bürkner, Niko Huurre, Kateřina Faltejsková, Andrew Gelman, and Aki Vehtari. 2023. <span>“Simulation-Based Calibration Checking for <span>Bayesian</span> Computation: <span>The</span> Choice of Test Quantities Shapes Sensitivity.”</span> <em>Bayesian Analysis</em>, 1–28. <a href="https://doi.org/10.1214/23-BA1404">https://doi.org/10.1214/23-BA1404</a>.
</div>
<div id="ref-NicenboimEtAl2025" class="csl-entry">
Nicenboim, Bruno, Daniel J. Schad, and Shravan Vasishth. 2025. <em>Introduction to Bayesian Data Analysis for Cognitive Science</em>. 1st ed. Chapman; Hall/CRC. <a href="https://doi.org/10.1201/9780429342646">https://doi.org/10.1201/9780429342646</a>.
</div>
<div id="ref-R-base" class="csl-entry">
R Core Team. 2025. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-talts2018validating" class="csl-entry">
Talts, Sean, Michael J. Betancourt, Daniel P. Simpson, Aki Vehtari, and Andrew Gelman. 2018. <span>“Validating <span>B</span>ayesian Inference Algorithms with Simulation-Based Calibration.”</span> <em>arXiv Preprint arXiv:1804.06788</em>.
</div>
<div id="ref-R-loo" class="csl-entry">
Vehtari, Aki, Jonah Gabry, Måns Magnusson, Yuling Yao, Paul-Christian Bürkner, Topi Paananen, and Andrew Gelman. 2024. <em>Loo: Efficient Leave-One-Out Cross-Validation and WAIC for Bayesian Models</em>. <a href="https://mc-stan.org/loo/">https://mc-stan.org/loo/</a>.
</div>
<div id="ref-R-ggplot2" class="csl-entry">
Wickham, Hadley, Winston Chang, Lionel Henry, Thomas Lin Pedersen, Kohske Takahashi, Claus Wilke, Kara Woo, Hiroaki Yutani, Dewey Dunnington, and Teun van den Brand. 2025. <em>Ggplot2: Create Elegant Data Visualisations Using the Grammar of Graphics</em>. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>with considerable extra work we could also deal with <code>sigma</code><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
